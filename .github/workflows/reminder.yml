name: Discord Reminder

on:
  schedule:
    # 5:45 PM h·∫±ng ng√†y (UTC+7 = 10:45 UTC)
    - cron: "45 10 * * *"

    # 9:00 AM Th·ª© 6 (UTC+7 = 02:00 UTC)
    - cron: "0 2 * * 5"

  workflow_dispatch:

jobs:
  reminder:
    runs-on: ubuntu-latest

    env:
      DAILY_MESSAGE: |
        ‚è∞ **5:45 PM Reminder**
        M·ªçi ng∆∞·ªùi nh·ªõ ƒëi·ªÅn **file report** nh√©!

      WEEKLY_MESSAGE: |
        üö®üö® **BIG REMIND** üö®üö®
        H√¥m nay l√† **Th·ª© 6**!
        M·ªçi ng∆∞·ªùi nh·ªõ **FULL FILL LOGWORK cho c·∫£ tu·∫ßn** üí™

    steps:
      - name: Send reminder to Discord
        env:
          WEBHOOK_URL: ${{ secrets.DISCORD_WEBHOOK }}
          CRON_EXPR: ${{ github.event.schedule }}
        run: |
          if [ "$CRON_EXPR" = "0 2 * * 5" ]; then
            MESSAGE="$WEEKLY_MESSAGE"
          else
            MESSAGE="$DAILY_MESSAGE"
          fi

          jq -n --arg content "$MESSAGE" \
            '{content: $content}' \
            | curl -s -X POST \
                -H "Content-Type: application/json" \
                -d @- \
                "$WEBHOOK_URL"
